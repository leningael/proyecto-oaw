<?php include 'config/bd.php';$sql=$conexion->prepare("SELECT DISTINCT categoria FROM feeds");$sql->execute();$listaCategorias=$sql->fetchAll(PDO::FETCH_ASSOC);$feedSelected=$_GET['feed'];$sentenciaSQL=$conexion->prepare("SELECT * FROM feeds WHERE nombre = :nombre");$sentenciaSQL->bindParam(':nombre',$feedSelected);$sentenciaSQL->execute();$datosFeed=$sentenciaSQL->fetch(PDO::FETCH_LAZY);$sentenciaSQL=$conexion->prepare("SELECT * FROM noticias WHERE id_feed = '".$datosFeed['id']."'");$sentenciaSQL->execute();$listaNoticias=$sentenciaSQL->fetchAll(PDO::FETCH_ASSOC); ?><!doctypehtml><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1"name="viewport"><meta content="Noticias de tu feed favorito"name="description"><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"rel="stylesheet"crossorigin="anonymous"integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"><link href="index.css"rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"rel="stylesheet"><title>Lector de Feeds</title></head><body><?php include('layouts/header.php'); ?><div class="container-fluid flex-nowrap"><div class="row"><?php include('layouts/sidebar.php'); ?><div class="col px-0"><section id="infoFeed"><div class="container-fluid"><div class="row"><div class="col-md-6 px-0"><img alt="Logo feed"class="logoFeed"src="<?php echo $datosFeed['logo']; ?>"></div><div class="col-md-6 align-self-center py-4"><h1><?php echo $datosFeed['nombre']; ?></h1><p><?php echo $datosFeed['descripcion']; ?></p><a class="btn btn-outline-light"href="<?php echo $datosFeed['linkFeed']; ?>">Visita el sitio web</a></div></div></div></section><section id="noticias"class="m-4"><div class="container"><div class="row"><div class="col"><div class="d-flex mb-2 justify-content-lg-end mpitob-lg-0"><form class="d-inline-block"><input aria-label="Search"class="me-2 form-control"id="searchBar"name="searchBar"placeholder="Buscar noticia"type="search"></form></div></div></div><div class="row"><div class="col"><div class="d-flex mb-2 flex-wrap"><a class="btn me-2 my-1 btn-primary"href="scripts/actualizarNoticias.php"id="refreshNews"><div class="d-inline-block align-text-top me-1 sprite sprite-actualizar"></div>Actualizar</a><div class="dropdown"><button class="btn me-2 my-1 btn-secondary dropdown-toggle"id="dropdownOrden"aria-expanded="false"data-bs-toggle="dropdown"type="button"><div class="d-inline-block align-text-top me-1 sprite sprite-ordenar"></div>Ordenar por</button><ul aria-labelledby="dropdownOrden"class="dropdown-menu"><li><button class="dropdown-item itemDrop"id="titleFirst">Título</button></li><li><button class="dropdown-item itemDrop"id="newFirst">Más recientes primero</button></li><li><button class="dropdown-item itemDrop"id="oldFirst">Más antiguos primero</button></li><li><button class="dropdown-item itemDrop"id="authorFirst">Autor</button></li></ul></div></div></div></div><div class="row"id="newsSpace"><?php foreach($listaNoticias as $noticia){ ?><div class="col-md-6 card-news col-lg-4 col-per col-xxl-3 mb-4"><button class="h-100 opnButton text-dark text-decoration-none"id="<?php echo $noticia['id']; ?>"style="background-color:transparent;border-color:transparent"><div class="h-100 card"><img alt="Foto noticia"class="card-img-top"src="<?php echo $noticia['imagen']; ?>"loading="lazy"><div class="card-body"><p class="card-title h5"><?php echo $noticia['titulo']; ?></p><?php $sentenciaSQL=$conexion->prepare("SELECT * FROM feeds WHERE id = :idFeed");$sentenciaSQL->bindParam(':idFeed',$noticia['id_feed']);$sentenciaSQL->execute();$feed=$sentenciaSQL->fetch(PDO::FETCH_LAZY); ?><a class="me-1 text-decoration-none"href="<?php echo $feed['linkFeed']; ?>"><?php echo $feed['nombre']; ?></a><small><?php date_default_timezone_set('America/Mexico_City');$fechaActual=date("Y-m-d H:i:s");$fechaNoticia=$noticia['fecha'];$datetime1=date_create($fechaNoticia);$datetime2=date_create($fechaActual);$intervalo=date_diff($datetime1,$datetime2);$diasAntiguedad=$intervalo->format('%a');$horasAntiguedad=$intervalo->format('%h');if($diasAntiguedad>1){$differenceFormat='hace %d días';}else if($diasAntiguedad==1){$differenceFormat='Ayer';}else{if($horasAntiguedad>1){$differenceFormat='hace %h horas';}else if($horasAntiguedad==1){$differenceFormat='hace %h hora';}else{$differenceFormat='hace %i minutos';}}echo $intervalo->format($differenceFormat); ?></small></div></div></button></div><?php } ?></div></div></section></div></div></div><?php include('layouts/modal.php'); ?><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"crossorigin="anonymous"integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"></script><script src="js/index.js"></script><script src="js/cargarNoticias.js"></script><script src="js/buscarNoticia.js"></script></body></html>